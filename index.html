<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <title>document</title>
    <link rel="stylesheet" href="styles/common.css">
</head>
<body>


<div id="scene1">
    <div class="man"></div>
    <div class="title"></div>
    <button class="rule"></button>
    <button class="start"></button>
</div>

<div id="scene2">
    <div class="countdown">
    </div>
    <div class="jigsaw"></div>
    <button class="btn-preview"></button>
</div>

<!-- 公共引用 -->
<script src="js/lib/hotcss.js"></script>
<script src="js/lib/zepto.js"></script>
<script src="js/lib/touch.js"></script>
<link rel="stylesheet" href="js/lib/dialog/game-dialog.css">
<script src="js/lib/dialog/game-dialog.js"></script>

<script src="js/lib/Watcher.js"></script>
<script src="js/tools/tools.js"></script>
<script src="js/lib/collisionChecker.js"></script>
<script src="js/lib/Dragify.js"></script>
<script src="js/lib/Countdown.js"></script>
<script src="js/lib/ani-queue.js"></script>

<!-- lottery -->
<link rel="stylesheet" href="js/lib/swiper/css/swiper.css">
<script src="js/lib/swiper/js/swiper.jquery.js"></script>

<link rel="stylesheet" href="js/lib/lottery-layer/lottery-layer.css">
<script src="js/lib/lottery-layer/lottery-layer.js"></script>


<script>
    window.GAME_PARAMS = {
        items: [
            {
                numIid      : 538178642523,
                picUrl      : "https://img.alicdn.com/bao/uploaded/i4/TB1.S.nNXXXXXXjXFXXXXXXXXXX_!!0-item_pic.jpg",
                price       : "346.00",
                soldQuantity: 0,
                title       : "测试商品圣高男 男士休闲皮 男真皮英伦潮流套脚商务休闲子",
                used        : true,
                itemId      : 538178642523
            },
            {
                numIid      : 538260952779,
                picUrl      : "https://img.alicdn.com/bao/uploaded/i2/TB1ZAAkNXXXXXbOXFXXXXXXXXXX_!!0-item_pic.jpg",
                price       : "246.00",
                soldQuantity: 0,
                title       : "测试商品吉 男女通用系带拼色运动 网布防滑耐磨小道公路跑步",
                used        : true,
                itemId      : 538260952779
            },
            {
                numIid      : 538260952779,
                picUrl      : "https://img.alicdn.com/bao/uploaded/i2/TB1ZAAkNXXXXXbOXFXXXXXXXXXX_!!0-item_pic.jpg",
                price       : "246.00",
                soldQuantity: 0,
                title       : "测试商品吉 男女通用系带拼色运动 网布防滑耐磨小道公路跑步",
                used        : true,
                itemId      : 538260952779
            }
        ],
        time : 6000000,
        sizeX: 2,
        sizeY: 2
    }

    var gameWatcher = window.gameWatcher = new Watcher()

    /**
     * 带*的为emit类型
     *
     * scene:
     *   ready 加载完毕
     *   start 点击开始
     *   win   通过
     *   fail  失败
     *
     * show:
     *   rule 规则
     *
     * game:
     *   *play   开始
     *   *replay 重玩
     */
    gameWatcher
            .on('scene:ready', function () {
                console.log('ready')
            })
            .on('scene:start', function () {
                gameWatcher.emit('game:play')
            })
            .on('show:rule', function () {
                console.log('rule')
            })
            .on('scene:win', function (time) {
                lotteryLayer.emit('show:win')
            })
            .on('scene:fail', function () {
                console.log('fail')
                gameWatcher.emit('game:replay')
                alert('fail')
            })

    var lotteryLayer = new LotteryLayer('112345123', {
        shopping: {
            items: []
        },
        collect : {
            items: [{id: 132}]
        },
    })

    //    lotteryLayer.emit('add:draw', 'game', 2)
    //    lotteryLayer.emit('add:draw', 'shopping')

    //    lotteryLayer.emit('show:win')
    //    lotteryLayer.emit('task:done', {numIid: 538260952779})
    lotteryLayer.emit('show:fail')
    lotteryLayer
            .on('click:task', function (type) {
//                $.showLoading()
                setTimeout(function () {
//                    $.hideLoading()
                    lotteryLayer.emit('done:task', type, [{numIid: 11}])
                    lotteryLayer.emit('show:task', type)
                }, 100)
            })
            .on('do:task', function (type, item) {
                console.log(item)
                lotteryLayer.emit('add:draw', type)
                lotteryLayer.emit('done:task', type, [item])
            })
            .on('click:draw', function (type) {
                console.log(type)
            })
</script>
<script src="js/app/Scene1.js"></script>
<script src="js/app/Scene2.js"></script>
<script src="js/main.js"></script>
</body>
</html>